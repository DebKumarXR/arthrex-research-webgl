var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},i=e.parcelRequiree52e;null==i&&((i=function(e){if(e in t)return t[e].exports;if(e in o){var i=o[e];delete o[e];var n={id:e,exports:{}};return t[e]=n,i.call(n.exports,n,n.exports),n.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){o[e]=t},e.parcelRequiree52e=i);var n=i("ilwiq"),s=i("jiuw3");const a=new(0,(n=i("ilwiq")).Raycaster),r=new(0,n.Vector3),l=new(0,n.Vector3),h=new(0,n.Quaternion),c={X:new(0,n.Vector3)(1,0,0),Y:new(0,n.Vector3)(0,1,0),Z:new(0,n.Vector3)(0,0,1)},d={type:"change"},p={type:"mouseDown"},m={type:"mouseUp",mode:null},u={type:"objectChange"};class w extends n.Object3D{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const o=new Y;this._gizmo=o,this.add(o);const i=new Z;this._plane=i,this.add(i);const s=this;function a(e,t){let n=t;Object.defineProperty(s,e,{get:function(){return void 0!==n?n:t},set:function(t){n!==t&&(n=t,i[e]=t,o[e]=t,s.dispatchEvent({type:e+"-changed",value:t}),s.dispatchEvent(d))}}),s[e]=t,i[e]=t,o[e]=t}a("camera",e),a("object",void 0),a("enabled",!0),a("axis",null),a("mode","translate"),a("translationSnap",null),a("rotationSnap",null),a("scaleSnap",null),a("space","world"),a("size",1),a("dragging",!1),a("showX",!0),a("showY",!0),a("showZ",!0);const r=new(0,n.Vector3),l=new(0,n.Vector3),h=new(0,n.Quaternion),c=new(0,n.Quaternion),p=new(0,n.Vector3),m=new(0,n.Quaternion),u=new(0,n.Vector3),w=new(0,n.Vector3),x=new(0,n.Vector3),S=new(0,n.Vector3);a("worldPosition",r),a("worldPositionStart",l),a("worldQuaternion",h),a("worldQuaternionStart",c),a("cameraPosition",p),a("cameraQuaternion",m),a("pointStart",u),a("pointEnd",w),a("rotationAxis",x),a("rotationAngle",0),a("eye",S),this._offset=new(0,n.Vector3),this._startNorm=new(0,n.Vector3),this._endNorm=new(0,n.Vector3),this._cameraScale=new(0,n.Vector3),this._parentPosition=new(0,n.Vector3),this._parentQuaternion=new(0,n.Quaternion),this._parentQuaternionInv=new(0,n.Quaternion),this._parentScale=new(0,n.Vector3),this._worldScaleStart=new(0,n.Vector3),this._worldQuaternionInv=new(0,n.Quaternion),this._worldScale=new(0,n.Vector3),this._positionStart=new(0,n.Vector3),this._quaternionStart=new(0,n.Quaternion),this._scaleStart=new(0,n.Vector3),this._getPointer=y.bind(this),this._onPointerDown=b.bind(this),this._onPointerHover=M.bind(this),this._onPointerMove=g.bind(this),this._onPointerUp=f.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;a.setFromCamera(e,this.camera);const t=x(this._gizmo.picker[this.mode],a);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){a.setFromCamera(e,this.camera);const t=x(this._plane,a,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,p.mode=this.mode,this.dispatchEvent(p)}}pointerMove(e){const t=this.axis,o=this.mode,i=this.object;let n=this.space;if("scale"===o?n="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(n="world"),void 0===i||null===t||!1===this.dragging||-1!==e.button)return;a.setFromCamera(e,this.camera);const s=x(this._plane,a,!0);if(s){if(this.pointEnd.copy(s.point).sub(this.worldPositionStart),"translate"===o)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===n&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===n&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),i.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===n&&(i.position.applyQuaternion(h.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.position.applyQuaternion(this._quaternionStart)),"world"===n&&(i.parent&&i.position.add(r.setFromMatrixPosition(i.parent.matrixWorld)),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.parent&&i.position.sub(r.setFromMatrixPosition(i.parent.matrixWorld))));else if("scale"===o){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(e*=-1),l.set(e,e,e)}else r.copy(this.pointStart),l.copy(this.pointEnd),r.applyQuaternion(this._worldQuaternionInv),l.applyQuaternion(this._worldQuaternionInv),l.divide(r),-1===t.search("X")&&(l.x=1),-1===t.search("Y")&&(l.y=1),-1===t.search("Z")&&(l.z=1);i.scale.copy(this._scaleStart).multiply(l),this.scaleSnap&&(-1!==t.search("X")&&(i.scale.x=Math.round(i.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(i.scale.y=Math.round(i.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(i.scale.z=Math.round(i.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===o){this._offset.copy(this.pointEnd).sub(this.pointStart);const e=20/this.worldPosition.distanceTo(r.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(r.copy(this.rotationAxis).cross(this.eye))*e):"X"!==t&&"Y"!==t&&"Z"!==t||(this.rotationAxis.copy(c[t]),r.copy(c[t]),"local"===n&&r.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(r.cross(this.eye).normalize())*e),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===n&&"E"!==t&&"XYZE"!==t?(i.quaternion.copy(this._quaternionStart),i.quaternion.multiply(h.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),i.quaternion.copy(h.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),i.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(d),this.dispatchEvent(u)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(m.mode=this.mode,this.dispatchEvent(m)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(d),this.dispatchEvent(u),this.pointStart.copy(this.pointEnd))}getRaycaster(){return a}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function y(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};{const t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}}function M(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e))}}function b(e){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this.pointerDown(this._getPointer(e)))}function g(e){this.enabled&&this.pointerMove(this._getPointer(e))}function f(e){this.enabled&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}function x(e,t,o){const i=t.intersectObject(e,!0);for(let e=0;e<i.length;e++)if(i[e].object.visible||o)return i[e];return!1}const S=new(0,n.Euler),v=new(0,n.Vector3)(0,1,0),E=new(0,n.Vector3)(0,0,0),P=new(0,n.Matrix4),I=new(0,n.Quaternion),_=new(0,n.Quaternion),C=new(0,n.Vector3),T=new(0,n.Matrix4),G=new(0,n.Vector3)(1,0,0),A=new(0,n.Vector3)(0,1,0),Q=new(0,n.Vector3)(0,0,1),B=new(0,n.Vector3),O=new(0,n.Vector3),X=new(0,n.Vector3);class Y extends n.Object3D{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new(0,n.MeshBasicMaterial)({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new(0,n.LineBasicMaterial)({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),o=e.clone();o.opacity=.15;const i=t.clone();i.opacity=.5;const s=e.clone();s.color.setHex(16711680);const a=e.clone();a.color.setHex(65280);const r=e.clone();r.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const h=e.clone();h.color.setHex(65280),h.opacity=.5;const c=e.clone();c.color.setHex(255),c.opacity=.5;const d=e.clone();d.opacity=.25;const p=e.clone();p.color.setHex(16776960),p.opacity=.25;e.clone().color.setHex(16776960);const m=e.clone();m.color.setHex(7895160);const u=new(0,n.CylinderGeometry)(0,.04,.1,12);u.translate(0,.05,0);const w=new(0,n.BoxGeometry)(.08,.08,.08);w.translate(0,.04,0);const y=new(0,n.BufferGeometry);y.setAttribute("position",new(0,n.Float32BufferAttribute)([0,0,0,1,0,0],3));const M=new(0,n.CylinderGeometry)(.0075,.0075,.5,3);function b(e,t){const o=new(0,n.TorusGeometry)(e,.0075,3,64,t*Math.PI*2);return o.rotateY(Math.PI/2),o.rotateX(Math.PI/2),o}M.translate(0,.25,0);const g={X:[[new(0,n.Mesh)(u,s),[.5,0,0],[0,0,-Math.PI/2]],[new(0,n.Mesh)(u,s),[-.5,0,0],[0,0,Math.PI/2]],[new(0,n.Mesh)(M,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new(0,n.Mesh)(u,a),[0,.5,0]],[new(0,n.Mesh)(u,a),[0,-.5,0],[Math.PI,0,0]],[new(0,n.Mesh)(M,a)]],Z:[[new(0,n.Mesh)(u,r),[0,0,.5],[Math.PI/2,0,0]],[new(0,n.Mesh)(u,r),[0,0,-.5],[-Math.PI/2,0,0]],[new(0,n.Mesh)(M,r),null,[Math.PI/2,0,0]]],XYZ:[[new(0,n.Mesh)(new(0,n.OctahedronGeometry)(.1,0),d.clone()),[0,0,0]]],XY:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.15,.15,.01),c.clone()),[.15,.15,0]]],YZ:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.15,.15,.01),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},f={X:[[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[.3,0,0],[0,0,-Math.PI/2]],[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[0,.3,0]],[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[0,-.3,0],[0,0,Math.PI]]],Z:[[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[0,0,.3],[Math.PI/2,0,0]],[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new(0,n.Mesh)(new(0,n.OctahedronGeometry)(.2,0),o)]],XY:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.2,.2,.01),o),[.15,.15,0]]],YZ:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.2,.2,.01),o),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.2,.2,.01),o),[.15,0,.15],[-Math.PI/2,0,0]]]},x={START:[[new(0,n.Mesh)(new(0,n.OctahedronGeometry)(.01,2),i),null,null,null,"helper"]],END:[[new(0,n.Mesh)(new(0,n.OctahedronGeometry)(.01,2),i),null,null,null,"helper"]],DELTA:[[new(0,n.Line)(function(){const e=new(0,n.BufferGeometry);return e.setAttribute("position",new(0,n.Float32BufferAttribute)([0,0,0,1,1,1],3)),e}(),i),null,null,null,"helper"]],X:[[new(0,n.Line)(y,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new(0,n.Line)(y,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new(0,n.Line)(y,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},S={XYZE:[[new(0,n.Mesh)(b(.5,1),m),null,[0,Math.PI/2,0]]],X:[[new(0,n.Mesh)(b(.5,.5),s)]],Y:[[new(0,n.Mesh)(b(.5,.5),a),null,[0,0,-Math.PI/2]]],Z:[[new(0,n.Mesh)(b(.5,.5),r),null,[0,Math.PI/2,0]]],E:[[new(0,n.Mesh)(b(.75,1),p),null,[0,Math.PI/2,0]]]},v={AXIS:[[new(0,n.Line)(y,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},E={XYZE:[[new(0,n.Mesh)(new(0,n.SphereGeometry)(.25,10,8),o)]],X:[[new(0,n.Mesh)(new(0,n.TorusGeometry)(.5,.1,4,24),o),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new(0,n.Mesh)(new(0,n.TorusGeometry)(.5,.1,4,24),o),[0,0,0],[Math.PI/2,0,0]]],Z:[[new(0,n.Mesh)(new(0,n.TorusGeometry)(.5,.1,4,24),o),[0,0,0],[0,0,-Math.PI/2]]],E:[[new(0,n.Mesh)(new(0,n.TorusGeometry)(.75,.1,2,24),o)]]},P={X:[[new(0,n.Mesh)(w,s),[.5,0,0],[0,0,-Math.PI/2]],[new(0,n.Mesh)(M,s),[0,0,0],[0,0,-Math.PI/2]],[new(0,n.Mesh)(w,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new(0,n.Mesh)(w,a),[0,.5,0]],[new(0,n.Mesh)(M,a)],[new(0,n.Mesh)(w,a),[0,-.5,0],[0,0,Math.PI]]],Z:[[new(0,n.Mesh)(w,r),[0,0,.5],[Math.PI/2,0,0]],[new(0,n.Mesh)(M,r),[0,0,0],[Math.PI/2,0,0]],[new(0,n.Mesh)(w,r),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.15,.15,.01),c),[.15,.15,0]]],YZ:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.15,.15,.01),h),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.1,.1,.1),d.clone())]]},I={X:[[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[.3,0,0],[0,0,-Math.PI/2]],[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[0,.3,0]],[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[0,-.3,0],[0,0,Math.PI]]],Z:[[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[0,0,.3],[Math.PI/2,0,0]],[new(0,n.Mesh)(new(0,n.CylinderGeometry)(.2,0,.6,4),o),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.2,.2,.01),o),[.15,.15,0]]],YZ:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.2,.2,.01),o),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.2,.2,.01),o),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new(0,n.Mesh)(new(0,n.BoxGeometry)(.2,.2,.2),o),[0,0,0]]]},_={X:[[new(0,n.Line)(y,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new(0,n.Line)(y,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new(0,n.Line)(y,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function C(e){const t=new(0,n.Object3D);for(const o in e)for(let i=e[o].length;i--;){const n=e[o][i][0].clone(),s=e[o][i][1],a=e[o][i][2],r=e[o][i][3],l=e[o][i][4];n.name=o,n.tag=l,s&&n.position.set(s[0],s[1],s[2]),a&&n.rotation.set(a[0],a[1],a[2]),r&&n.scale.set(r[0],r[1],r[2]),n.updateMatrix();const h=n.geometry.clone();h.applyMatrix4(n.matrix),n.geometry=h,n.renderOrder=1/0,n.position.set(0,0,0),n.rotation.set(0,0,0),n.scale.set(1,1,1),t.add(n)}return t}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=C(g)),this.add(this.gizmo.rotate=C(S)),this.add(this.gizmo.scale=C(P)),this.add(this.picker.translate=C(f)),this.add(this.picker.rotate=C(E)),this.add(this.picker.scale=C(I)),this.add(this.helper.translate=C(x)),this.add(this.helper.rotate=C(v)),this.add(this.helper.scale=C(_)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const t="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:_;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let o=[];o=o.concat(this.picker[this.mode].children),o=o.concat(this.gizmo[this.mode].children),o=o.concat(this.helper[this.mode].children);for(let e=0;e<o.length;e++){const i=o[e];let n;if(i.visible=!0,i.rotation.set(0,0,0),i.position.copy(this.worldPosition),n=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),i.scale.set(1,1,1).multiplyScalar(n*this.size/4),"helper"!==i.tag){if(i.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode){const e=.99,o=.2;"X"===i.name&&Math.abs(v.copy(G).applyQuaternion(t).dot(this.eye))>e&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"Y"===i.name&&Math.abs(v.copy(A).applyQuaternion(t).dot(this.eye))>e&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"Z"===i.name&&Math.abs(v.copy(Q).applyQuaternion(t).dot(this.eye))>e&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"XY"===i.name&&Math.abs(v.copy(Q).applyQuaternion(t).dot(this.eye))<o&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"YZ"===i.name&&Math.abs(v.copy(G).applyQuaternion(t).dot(this.eye))<o&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"XZ"===i.name&&Math.abs(v.copy(A).applyQuaternion(t).dot(this.eye))<o&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1)}else"rotate"===this.mode&&(I.copy(t),v.copy(this.eye).applyQuaternion(h.copy(t).invert()),-1!==i.name.search("E")&&i.quaternion.setFromRotationMatrix(P.lookAt(this.eye,E,A)),"X"===i.name&&(h.setFromAxisAngle(G,Math.atan2(-v.y,v.z)),h.multiplyQuaternions(I,h),i.quaternion.copy(h)),"Y"===i.name&&(h.setFromAxisAngle(A,Math.atan2(v.x,v.z)),h.multiplyQuaternions(I,h),i.quaternion.copy(h)),"Z"===i.name&&(h.setFromAxisAngle(Q,Math.atan2(v.y,v.x)),h.multiplyQuaternions(I,h),i.quaternion.copy(h)));i.visible=i.visible&&(-1===i.name.indexOf("X")||this.showX),i.visible=i.visible&&(-1===i.name.indexOf("Y")||this.showY),i.visible=i.visible&&(-1===i.name.indexOf("Z")||this.showZ),i.visible=i.visible&&(-1===i.name.indexOf("E")||this.showX&&this.showY&&this.showZ),i.material._color=i.material._color||i.material.color.clone(),i.material._opacity=i.material._opacity||i.material.opacity,i.material.color.copy(i.material._color),i.material.opacity=i.material._opacity,this.enabled&&this.axis&&(i.name===this.axis||this.axis.split("").some((function(e){return i.name===e})))&&(i.material.color.setHex(16776960),i.material.opacity=1)}else i.visible=!1,"AXIS"===i.name?(i.visible=!!this.axis,"X"===this.axis&&(h.setFromEuler(S.set(0,0,0)),i.quaternion.copy(t).multiply(h),Math.abs(v.copy(G).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"Y"===this.axis&&(h.setFromEuler(S.set(0,0,Math.PI/2)),i.quaternion.copy(t).multiply(h),Math.abs(v.copy(A).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"Z"===this.axis&&(h.setFromEuler(S.set(0,Math.PI/2,0)),i.quaternion.copy(t).multiply(h),Math.abs(v.copy(Q).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"XYZE"===this.axis&&(h.setFromEuler(S.set(0,Math.PI/2,0)),v.copy(this.rotationAxis),i.quaternion.setFromRotationMatrix(P.lookAt(E,v,A)),i.quaternion.multiply(h),i.visible=this.dragging),"E"===this.axis&&(i.visible=!1)):"START"===i.name?(i.position.copy(this.worldPositionStart),i.visible=this.dragging):"END"===i.name?(i.position.copy(this.worldPosition),i.visible=this.dragging):"DELTA"===i.name?(i.position.copy(this.worldPositionStart),i.quaternion.copy(this.worldQuaternionStart),r.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),r.applyQuaternion(this.worldQuaternionStart.clone().invert()),i.scale.copy(r),i.visible=this.dragging):(i.quaternion.copy(t),this.dragging?i.position.copy(this.worldPositionStart):i.position.copy(this.worldPosition),this.axis&&(i.visible=-1!==this.axis.search(i.name)))}super.updateMatrixWorld(e)}}class Z extends n.Mesh{constructor(){super(new(0,n.PlaneGeometry)(1e5,1e5,2,2),new(0,n.MeshBasicMaterial)({visible:!1,wireframe:!0,side:n.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),B.copy(G).applyQuaternion("local"===t?this.worldQuaternion:_),O.copy(A).applyQuaternion("local"===t?this.worldQuaternion:_),X.copy(Q).applyQuaternion("local"===t?this.worldQuaternion:_),v.copy(O),this.mode){case"translate":case"scale":switch(this.axis){case"X":v.copy(this.eye).cross(B),C.copy(B).cross(v);break;case"Y":v.copy(this.eye).cross(O),C.copy(O).cross(v);break;case"Z":v.copy(this.eye).cross(X),C.copy(X).cross(v);break;case"XY":C.copy(X);break;case"YZ":C.copy(B);break;case"XZ":v.copy(X),C.copy(O);break;case"XYZ":case"E":C.set(0,0,0)}break;default:C.set(0,0,0)}0===C.length()?this.quaternion.copy(this.cameraQuaternion):(T.lookAt(r.set(0,0,0),C,v),this.quaternion.setFromRotationMatrix(T)),super.updateMatrixWorld(e)}}var V=i("5Rd1x"),z=i("7lx9d"),L=i("kp7Te"),F=i("8Zfx2"),W=i("4CEV9");window.logTriangleDefinitions=W.logTriangleDefinitions;const H={brush1Shape:"box",brush1Complexity:1,brush1Color:"#ffffff",brush2Shape:"sphere",brush2Complexity:1,brush2Color:"#E91E63",operation:W.SUBTRACTION,wireframe:!1,displayBrushes:!0,displayControls:!0,shadows:!0,vertexColors:!1,flatShading:!1,gridTexture:!1,useGroups:!0,enableDebugTelemetry:!0,displayIntersectionEdges:!1,displayTriangleIntersections:!1,displayBrush1BVH:!1,displayBrush2BVH:!1};let D,R,j,k,N,U,q,K,$,J,ee,te,oe,ie,ne,se,ae,re,le,he=!0;const ce=new Map;function de(e,t,o){switch(e.geometry.dispose(),t){case"sphere":e.geometry=new(0,n.SphereGeometry)(1,Math.round(n.MathUtils.lerp(5,32,o)),Math.round(n.MathUtils.lerp(5,16,o)));break;case"box":const t=Math.round(n.MathUtils.lerp(1,10,o));e.geometry=new(0,n.BoxGeometry)(1,1,1,t,t,t);break;case"cylinder":e.geometry=new(0,n.CylinderGeometry)(.5,.5,1,Math.round(n.MathUtils.lerp(5,32,o)));break;case"torus":e.geometry=new(0,n.TorusGeometry)(.6,.2,Math.round(n.MathUtils.lerp(4,16,o)),Math.round(n.MathUtils.lerp(6,30,o)));break;case"torus knot":e.geometry=new(0,n.TorusKnotGeometry)(.6,.2,Math.round(n.MathUtils.lerp(16,64,o)),Math.round(n.MathUtils.lerp(4,16,o)));break;case"mesh":e.geometry=re.clone()}e.geometry=e.geometry.toNonIndexed();const i=e.geometry.attributes.position,s=new Float32Array(3*i.count);for(let e=0,t=s.length;e<t;e+=9)s[e+0]=1,s[e+1]=0,s[e+2]=0,s[e+3]=0,s[e+4]=1,s[e+5]=0,s[e+6]=0,s[e+7]=0,s[e+8]=1;e.geometry.setAttribute("color",new(0,n.BufferAttribute)(s,3)),e.prepareGeometry(),he=!0}function pe(){requestAnimationFrame(pe),$.scale.x=Math.max($.scale.x,.01),$.scale.y=Math.max($.scale.y,.01),$.scale.z=Math.max($.scale.z,.01);const e=H.enableDebugTelemetry;if(he){he=!1,K.updateMatrixWorld(),$.updateMatrixWorld();const t=window.performance.now();le.debug.enabled=e,le.useGroups=H.useGroups,le.evaluate(K,$,H.operation,J),H.useGroups?J.material=J.material.map((e=>ce.get(e))):J.material=oe;const o=window.performance.now()-t;N.innerText=`${o.toFixed(3)}ms`,e&&(ie.setEdges(le.debug.intersectionEdges),ne.setTriangles([...le.debug.triangleIntersectsA.getTrianglesAsArray(),...le.debug.triangleIntersectsA.getIntersectionsAsArray()]))}ee.visible=H.wireframe,K.visible=H.displayBrushes,$.visible=H.displayBrushes,te.castShadow=H.shadows,q.enabled=H.displayControls,q.visible=H.displayControls,ie.visible=e&&H.displayIntersectionEdges,ne.visible=e&&H.displayTriangleIntersections,se.visible=H.displayBrush1BVH,ae.visible=H.displayBrush2BVH,D.render(j,R)}!async function(){N=document.getElementById("output"),D=new(0,n.WebGLRenderer)({antialias:!0}),D.setPixelRatio(window.devicePixelRatio),D.setSize(window.innerWidth,window.innerHeight),D.setClearColor(1118481,1),D.shadowMap.enabled=!0,D.shadowMap.type=n.PCFSoftShadowMap,document.body.appendChild(D.domElement),j=new(0,n.Scene),te=new(0,n.DirectionalLight)(16777215,3.5),te.position.set(-1,2,3),j.add(te,te.target),j.add(new(0,n.AmbientLight)(11583173,.35));const e=te.shadow.camera;let t;te.castShadow=!0,te.shadow.mapSize.setScalar(4096),te.shadow.bias=1e-5,te.shadow.normalBias=.01,e.left=e.bottom=-2.5,e.right=e.top=2.5,e.updateProjectionMatrix(),R=new(0,n.PerspectiveCamera)(75,window.innerWidth/window.innerHeight,.1,50),R.position.set(1,2,4),R.far=100,R.updateProjectionMatrix(),U=new(0,V.OrbitControls)(R,D.domElement),q=new w(R,D.domElement),q.setSize(.75),q.addEventListener("dragging-changed",(e=>{U.enabled=!e.value})),q.addEventListener("objectChange",(()=>{he=!0})),j.add(q),le=new(0,W.Evaluator),le.attributes=["position","normal"],K=new(0,W.Brush)(new(0,n.BoxGeometry),new(0,W.GridMaterial)),$=new(0,W.Brush)(new(0,n.BoxGeometry),new(0,W.GridMaterial)),$.position.set(-.75,.75,0),$.scale.setScalar(.75),de(K,H.brush1Shape,H.brush1Complexity),de($,H.brush2Shape,H.brush2Complexity),K.material.opacity=.15,K.material.transparent=!0,K.material.depthWrite=!1,K.material.polygonOffset=!0,K.material.polygonOffsetFactor=.2,K.material.polygonOffsetUnits=.2,K.material.side=n.DoubleSide,K.material.premultipliedAlpha=!0,$.material.opacity=.15,$.material.transparent=!0,$.material.depthWrite=!1,$.material.polygonOffset=!0,$.material.polygonOffsetFactor=.2,$.material.polygonOffsetUnits=.2,$.material.side=n.DoubleSide,$.material.premultipliedAlpha=!0,$.material.roughness=.25,$.material.color.set(15277667),K.receiveShadow=!0,$.receiveShadow=!0,q.attach($),j.add(K,$),t=K.material.clone(),t.side=n.FrontSide,t.opacity=1,t.transparent=!1,t.depthWrite=!0,ce.set(K.material,t),t=$.material.clone(),t.side=n.FrontSide,t.opacity=1,t.transparent=!1,t.depthWrite=!0,ce.set($.material,t),ce.forEach(((e,t)=>{e.enableGrid=H.gridTexture,t.enableGrid=H.gridTexture})),J=new(0,n.Mesh)(new(0,n.BufferGeometry),new(0,n.MeshStandardMaterial)({flatShading:!1,polygonOffset:!0,polygonOffsetUnits:.1,polygonOffsetFactor:.1})),J.castShadow=!0,J.receiveShadow=!0,oe=J.material,j.add(J),ee=new(0,n.Mesh)(J.geometry,new(0,n.MeshBasicMaterial)({wireframe:!0,color:0,opacity:.15,transparent:!0})),j.add(ee),ie=new(0,W.EdgesHelper),ie.color.set(15277667),j.add(ie),ne=new(0,W.TriangleSetHelper),ne.color.set(48340),j.add(ne),se=new(0,F.MeshBVHVisualizer)(K,20),ae=new(0,F.MeshBVHVisualizer)($,20),j.add(se,ae),se.update(),ae.update();const o=await(new(0,z.GLTFLoader)).setMeshoptDecoder(L.MeshoptDecoder).loadAsync("https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/stanford-bunny/bunny.glb");re=o.scene.children[0].geometry,re.computeVertexNormals(),k=new(0,s.GUI),k.add(H,"operation",{ADDITION:W.ADDITION,SUBTRACTION:W.SUBTRACTION,REVERSE_SUBTRACTION:W.REVERSE_SUBTRACTION,INTERSECTION:W.INTERSECTION,DIFFERENCE:W.DIFFERENCE,HOLLOW_INTERSECTION:W.HOLLOW_INTERSECTION,HOLLOW_SUBTRACTION:W.HOLLOW_SUBTRACTION}).onChange((e=>{he=!0,e===W.HOLLOW_INTERSECTION||e===W.HOLLOW_SUBTRACTION?ce.forEach((e=>e.side=n.DoubleSide)):ce.forEach((e=>e.side=n.FrontSide))})),k.add(H,"displayBrushes"),k.add(H,"displayControls"),k.add(H,"shadows"),k.add(H,"useGroups").onChange((()=>he=!0)),k.add(H,"vertexColors").onChange((e=>{K.material.vertexColors=e,K.material.needsUpdate=!0,$.material.vertexColors=e,$.material.needsUpdate=!0,ce.forEach((t=>{t.vertexColors=e,t.needsUpdate=!0})),le.attributes=e?["color","position","normal"]:["position","normal"],he=!0})),k.add(H,"gridTexture").onChange((e=>{ce.forEach(((t,o)=>{t.enableGrid=e,o.enableGrid=e}))})),k.add(H,"flatShading").onChange((e=>{K.material.flatShading=e,K.material.needsUpdate=!0,$.material.flatShading=e,$.material.needsUpdate=!0,ce.forEach((t=>{t.flatShading=e,t.needsUpdate=!0}))}));const i=k.addFolder("brush 1");i.add(H,"brush1Shape",["sphere","box","cylinder","torus","torus knot","mesh"]).name("shape").onChange((e=>{de(K,e,H.brush1Complexity),se.update()})),i.add(H,"brush1Complexity",0,2).name("complexity").onChange((e=>{de(K,H.brush1Shape,e),se.update()})),i.addColor(H,"brush1Color").onChange((e=>{K.material.color.set(e),ce.get(K.material).color.set(e)}));const a=k.addFolder("brush 2");a.add(H,"brush2Shape",["sphere","box","cylinder","torus","torus knot","mesh"]).name("shape").onChange((e=>{de($,e,H.brush2Complexity),ae.update()})),a.add(H,"brush2Complexity",0,2).name("complexity").onChange((e=>{de($,H.brush2Shape,e),ae.update()})),a.addColor(H,"brush2Color").onChange((e=>{$.material.color.set(e),ce.get($.material).color.set(e)}));const r=k.addFolder("debug");r.add(H,"enableDebugTelemetry").onChange((()=>he=!0)),r.add(H,"displayIntersectionEdges"),r.add(H,"displayTriangleIntersections"),r.add(H,"wireframe"),r.add(H,"displayBrush1BVH"),r.add(H,"displayBrush2BVH"),q.setMode("rotate"),window.addEventListener("resize",(function(){R.aspect=window.innerWidth/window.innerHeight,R.updateProjectionMatrix(),D.setSize(window.innerWidth,window.innerHeight)}),!1),window.addEventListener("keydown",(function(e){switch(e.code){case"KeyW":q.setMode("translate");break;case"KeyE":q.setMode("rotate");break;case"KeyR":q.setMode("scale")}})),pe()}();
//# sourceMappingURL=simple.fddf0cf1.js.map
